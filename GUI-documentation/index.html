<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice 4.0.1  (Unix)">
	<META NAME="AUTHOR" CONTENT="Leighton Hargreaves">
	<META NAME="CREATED" CONTENT="20100617;11551100">
	<META NAME="CHANGEDBY" CONTENT="Leighton Hargreaves">
	<META NAME="CHANGED" CONTENT="20100629;20020284">
	<STYLE TYPE="text/css">
	<!--
		@page { margin: 2cm }
		P { margin-bottom: 0.21cm; direction: ltr; color: #000000; widows: 0; orphans: 0 }
		P.western { font-family: "Arial", sans-serif; font-size: 10pt }
		P.cjk { font-family: "Lucida Sans Unicode"; font-size: 12pt; so-language: zh-CN }
		P.ctl { font-family: "Tahoma"; font-size: 12pt; so-language: hi-IN }
		H1 { margin-bottom: 0.21cm; direction: ltr; color: #000000; widows: 0; orphans: 0 }
		H1.western { font-family: "Arial", sans-serif }
		H1.cjk { font-family: "Lucida Sans Unicode"; font-size: 16pt; so-language: zh-CN }
		H1.ctl { font-family: "Tahoma"; font-size: 16pt; so-language: hi-IN }
		H2 { margin-bottom: 0.21cm; direction: ltr; color: #000000; widows: 0; orphans: 0 }
		H2.western { font-family: "Arial", sans-serif; font-size: 20pt; font-style: italic }
		H2.cjk { font-family: "Lucida Sans Unicode"; font-size: 14pt; so-language: zh-CN; font-style: italic }
		H2.ctl { font-family: "Tahoma"; font-size: 14pt; so-language: hi-IN; font-style: italic }
		H3 { margin-bottom: 0.21cm; direction: ltr; color: #000000; widows: 0; orphans: 0 }
		H3.western { font-family: "Arial", sans-serif; font-size: 16pt }
		H3.cjk { so-language: zh-CN }
		H3.ctl { so-language: hi-IN }
		H4 { margin-bottom: 0.21cm; direction: ltr; color: #000000; widows: 0; orphans: 0 }
		H4.western { font-family: "Arial", sans-serif; font-size: 14pt; font-style: italic }
		H4.cjk { font-family: "Lucida Sans Unicode"; so-language: zh-CN; font-style: italic }
		H4.ctl { font-family: "Tahoma"; so-language: hi-IN; font-style: italic }
		PRE { direction: ltr; color: #000000; widows: 0; orphans: 0 }
		PRE.cjk { so-language: zh-CN }
		PRE.ctl { so-language: hi-IN }
		H5 { margin-left: 0.76cm; margin-right: 0.2cm; text-indent: -0.76cm; margin-top: 0cm; margin-bottom: 0cm; direction: ltr; color: #000000; widows: 0; orphans: 0 }
		H5.western { font-family: "Arial", sans-serif; font-size: 11pt }
		H5.cjk { font-family: "Lucida Sans Unicode"; font-size: 11pt; so-language: zh-CN }
		H5.ctl { font-family: "Tahoma"; font-size: 11pt; so-language: hi-IN }
		H6 { margin-bottom: 0.21cm; direction: ltr; color: #000000; widows: 0; orphans: 0 }
		H6.western { font-family: "Arial", sans-serif; font-size: 10pt; font-style: italic }
		H6.cjk { font-family: "Lucida Sans Unicode"; font-size: 10pt; so-language: zh-CN }
		H6.ctl { font-family: "Tahoma"; font-size: 10pt; so-language: hi-IN }
		TD P { margin-bottom: 0cm; direction: ltr; color: #000000; widows: 0; orphans: 0 }
		TD P.western { font-family: "Arial", sans-serif; font-size: 10pt }
		TD P.cjk { font-family: "Lucida Sans Unicode"; font-size: 12pt; so-language: zh-CN }
		TD P.ctl { font-family: "Tahoma"; font-size: 12pt; so-language: hi-IN }
		TH P { margin-bottom: 0cm; direction: ltr; color: #000000; widows: 0; orphans: 0 }
		TH P.western { font-family: "Arial", sans-serif; font-size: 10pt }
		TH P.cjk { font-family: "Lucida Sans Unicode"; font-size: 12pt; so-language: zh-CN }
		TH P.ctl { font-family: "Tahoma"; font-size: 12pt; so-language: hi-IN }
		A:link { so-language: zxx }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-GB" TEXT="#000000" BGCOLOR="#ffffff" DIR="LTR">
<OL>
	<LI><H1 CLASS="western" ALIGN=CENTER>Documentation of IntegraLive
	GUI</H1>
</OL>
<P CLASS="western" STYLE="margin-bottom: 0cm">Leighton Hargreaves</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">17-06-10 (NOTE: THIS DOCUMENT NEEDS UPDATING)</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<DIV ID="Section3" DIR="LTR">
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<H2 CLASS="western" STYLE="page-break-before: always">1.Introduction</H2>
	<H3 CLASS="western">1.1.Purpose of this document</H3>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>This
	document seeks to provide a top down description of the
	implementation of the Integra Live GUI, including application-wide
	patterns and concepts, and any important exceptions to these
	patterns.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>It
	is intended to provide software developers with enough information
	about how the application has been written to allow them to
	maintain, fix bugs, or continue development of the software.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<H3 CLASS="western">1.2.Overview of the system</H3>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>IntegraLive
	GUI is written in Flex 3, using a combination of AS3 and MXML.  It
	targets the Adobe Air runtime, which is available for a variety of
	platforms including Windows, OSX and Linux.  </FONT></FONT>
	</P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>IntegraLive
	GUI constitutes the 'client' end of a simple client/server
	architecture; it communicates using local XML RPC with a backend
	called 'libIntegra'.  </FONT></FONT>
	</P>
	<P CLASS="western"><BR><BR>
	</P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>IntegraLive
	GUI consists of a main application, distributable as a .swf file
	(shockwave flash binary), and a set of control plugins, each of
	which is also distributable as a .swf file.  These control plugins
	are loaded at runtime by the main application, and have
	bi-directional communication with the main application using flash
	'local connections'.  The plugin architecture is described more
	fully in a separate document called “</FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><B>Integra
	Live GUI Control Plugin Architecture</B></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2>”.</FONT></FONT></P>
	<P CLASS="western"><BR><BR>
	</P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>This
	component relationship is illustrated in the following diagram:</FONT></FONT></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>S<IMG SRC="Documentation%20of%20Integra%20Live%20GUI_html_23441092.gif" NAME="Object1" ALIGN=LEFT WIDTH=403 HEIGHT=570><BR CLEAR=LEFT>ince
	the control plugins are described in a separate document, this
	document will restrict itself to describing the main application
	“IntegraLive GUI”.</FONT></FONT></P>
	<P CLASS="western"><BR><BR>
	</P>
	<H3 CLASS="western">1.3.Build Environment</H3>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	source code for IntegraLive GUI is in SourceForge at
	<A HREF="http://sourceforge.net/projects/integralive">http://sourceforge.net/projects/integralive</A></FONT></FONT></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>To
	check out a working copy from SVN: </FONT></FONT>
	</P>
	<P CLASS="western">“<FONT FACE="Arial, sans-serif"><FONT SIZE=2>svn
	co </FONT></FONT>https://integralive.svn.sourceforge.new/svnroot/integralive<FONT FACE="Arial, sans-serif"><FONT SIZE=2>
	integralive”</FONT></FONT></P>
	<H4 CLASS="western">1.3.1.Compile time dependencies</H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>IntegraLive
	GUI has two compile-time dependencies: </FONT></FONT>
	</P>
	<H5 CLASS="western"><FONT FACE="Arial, sans-serif">1.3.1.1.XMLRPC
	for Actionscript 3.0</FONT></H5>
	<P CLASS="western"><FONT SIZE=2><FONT FACE="Arial, sans-serif">The
	original version of this XMLRPC library is available here
	</FONT><A HREF="http://danielmclaren.net/2007/08/03/xmlrpc-for-actionscript-30-free-library"><FONT FACE="Arial, sans-serif">http://danielmclaren.net/2007/08/03/xmlrpc-for-actionscript-30-free-library</FONT></A></FONT></P>
	<P CLASS="western"><BR><BR>
	</P>
	<P CLASS="western"><FONT SIZE=2><FONT FACE="Arial, sans-serif">However,
	I have been forced to make an important bugfix to this library in
	order for it to be able to handle nested arrays.  This fix has been
	submitted to the author in the hope that they include it in a future
	release.  In the meantime, the fixed version is available here: 
	</FONT><A HREF="http://www.integralive.org/incoming/as3_xmlrpc.zip"><FONT FACE="Arial, sans-serif">http://www.integralive.org/incoming/as3_xmlrpc.zip</FONT></A><FONT FACE="Arial, sans-serif">
	 </FONT></FONT>
	</P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>To
	add this dependency to IntegraLive GUI's build environment, place
	its &lt;com&gt; source directory below IntegraLive GUI's &lt;src&gt;
	directory.</FONT></FONT></P>
	<H5 CLASS="western"><FONT FACE="Arial, sans-serif">1.3.1.2.FlexUnit
	0.9</FONT></H5>
	<P CLASS="western"><FONT FACE="Arial, sans-serif">FlexUnit 0.9 is a
	unit testing framework for Flex and ActionScript 3 applications.  It
	is only used for its </FONT><FONT FACE="Arial, sans-serif"><I>Assert</I></FONT><FONT FACE="Arial, sans-serif">
	class.  It is available from
	</FONT><A HREF="http://opensource.adobe.com/wiki/display/flexunit/Downloads"><FONT FACE="Arial, sans-serif">http://opensource.adobe.com/wiki/display/flexunit/Downloads</FONT></A></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif">To add this
	dependency to </FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2>IntegraLive
	GUI's build environment, place the file “FlexUnit.swc” in the
	directory src/libs/.</FONT></FONT></P>
	<P CLASS="western"><BR><BR>
	</P>
	<H3 CLASS="western">1.4.Coding Standards</H3>
	<P CLASS="western"><BR><BR>
	</P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>These
	Coding Standards are also available in the Integra Wiki
	(</FONT></FONT><FONT COLOR="#000080"><SPAN LANG="zxx"><U><A HREF="http://www.integralive.org/dokuwiki/doku.php/coding_guidelines"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>http://www.integralive.org/dokuwiki/doku.php/coding_guidelines</FONT></FONT></A></U></SPAN></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2>)</FONT></FONT></P>
	<H4 CLASS="western">1.4.1.<STRONG><FONT FACE="Arial, sans-serif">File
	structure</FONT></STRONG><FONT FACE="Arial, sans-serif"> </FONT>
	</H4>
	<UL>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif">Standard gnu
		license agreement at top of every file </FONT>
		</P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif">Functions
		within a class should always be ordered as follows: constructor,
		public functions, protected functions, private functions.</FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif">Virtual and
		override functions should be grouped together wherever this is
		sensible.</FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif">Functions
		relating to similar areas of functionality should be grouped
		together wherever this is sensible.</FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif">All variables
		should be declared private, with public getters/setters as needed.</FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif">All variables
		should be initialised where they are declared.</FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif">The
		ActionScript 3 typed Vector class should be used in preference to
		the untyped Array class where possible.</FONT></P>
	</UL>
	<H4 CLASS="western">1.4.2.<STRONG>Naming conventions</STRONG> 
	</H4>
	<UL>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif">Classes
		should be named in upper camel case.</FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif">Functions,
		variables and constants should be named in lower camel case.</FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif">Class member
		variables and consts should be preceded with an underscore, to
		distinguish them from local variables and consts.</FONT></P>
	</UL>
	<P CLASS="western"><BR><BR>
	</P>
	<H4 CLASS="western">1.4.3.<STRONG><FONT FACE="Arial, sans-serif">E</FONT></STRONG><STRONG>numerations</STRONG>
		</H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif">There is no native
	'enumeration' type in Actionscript. A common Actionscript
	convention, also used in the Integra Live </FONT><FONT FACE="Arial, sans-serif">GUI</FONT><FONT FACE="Arial, sans-serif">,
	is to define enumerations as classes whose only content is a set of
	public static const Strings, one for each enumeration value.  When
	enumerations are only needed internally by one class, the set of
	static const Strings can be defined privately within that class,
	instead of in a separate class.</FONT></P>
	<P CLASS="western"><BR><BR>
	</P>
	<H4 CLASS="western">1.4.4.<STRONG>Indentation style</STRONG></H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif">IntegraLive GUI
	uses the Allman style ( </FONT><FONT COLOR="#000080"><SPAN LANG="zxx"><U><A HREF="http://en.wikipedia.org/wiki/Indent_style"><FONT FACE="Arial, sans-serif">http://en.wikipedia.org/wiki/Indent_style</FONT></A></U></SPAN></FONT><FONT FACE="Arial, sans-serif">
	) </FONT>
	</P>
	<P CLASS="western"><BR><BR>
	</P>
	<H4 CLASS="western">1.4.5.<STRONG>Code flow style</STRONG> 
	</H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif">Minimise
	indentation. EG instead of </FONT>
	</P>
	<PRE CLASS="western">function doSomething
{
        if( condition1 )
        {
                if( condition2 )
                {
                        if( condition3 )
                        {
                                doSomethingElse();
                        }
                }
        }
}</PRE><P CLASS="western">
	<FONT FACE="Arial, sans-serif">it's better to write </FONT>
	</P>
	<PRE CLASS="western">function doSomething
{
        if( !condition1 )
        {
                return;
        }
        
        if( !condition2 )
        {
                return;
        }

        if( !condition3 )
        {
                return;
        }

        doSomethingElse();
}</PRE><H4 CLASS="western">
	1.4.6.<STRONG>switch statements</STRONG> 
	</H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif">Switch statements
	should always contain a 'default case'. If the default is not
	expected to be used (eg when there's a case for each value of an
	enumeration), the default case should fail an assertion, to alert
	developers to a possible error. </FONT>
	</P>
	<H4 CLASS="western">1.4.7.<STRONG>Defensive programming - assertions
	and failsafe mechanisms</STRONG> 
	</H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif">There is no native
	'Assert' functionality in Actionscript. The IntegraLive GUI uses a
	3rd party component called 'FlexUnit'
	(</FONT><FONT COLOR="#000080"><SPAN LANG="zxx"><U><A HREF="http://opensource.adobe.com/wiki/display/flexunit/FlexUnit"><FONT FACE="Arial, sans-serif">http://opensource.adobe.com/wiki/display/flexunit/FlexUnit</FONT></A></U></SPAN></FONT><FONT FACE="Arial, sans-serif">),
	which provides an 'Assert' class. Assertions should be used as
	liberally as possible. Furthermore, in any situation where an
	assertion failure is likely to cause a significant software
	malfunction, and where a simple failsafe mechanism is possible, one
	should be implemented. </FONT>
	</P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif">Example of
	assertion without failsafe mechanism: </FONT>
	</P>
	<PRE CLASS="western">Assert.assertNotNull( referenceToSomething )
//subsequent code which relies on referenceToSomething</PRE><P CLASS="western">
	<FONT FACE="Arial, sans-serif">Example of assertion with failsafe
	mechanism: </FONT>
	</P>
	<PRE CLASS="western">if( referenceToSomething == null )
{
        Assert.assertTrue( false );
        return;
}
//subsequent code which relies on referenceToSomething
</PRE><H2 CLASS="western">
	2.Structure of IntegraLive GUI</H2>
	<H3 CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=4>2.1.MVC
	(Model/View/Controller) </FONT></FONT>
	</H3>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>IntegraLive
	GUI employs a simple MVC pattern
	(</FONT></FONT><FONT COLOR="#000080"><SPAN LANG="zxx"><U><A HREF="http://en.wikipedia.org/wiki/model-view-controller"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>http://en.wikipedia.org/wiki/model-view-controller</FONT></FONT></A></U></SPAN></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2>)
	in order to impose a topdown structure onto the various components
	of the application, and maximise encapsulation of functionality.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	key attributes of this pattern as as follows:</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<UL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
		Model has no knowledge of the views or controller</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
		Controller has no knowledge of the views</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
		Views have no knowledge of other views</FONT></FONT></P>
	</UL>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<H3 CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=4>2.2.Framework
	and Utilities</FONT></FONT></H3>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	only parts of the application which are not part of the MVC are as
	follows:</FONT></FONT></P>
	<H4 CLASS="western"><FONT FACE="Arial, sans-serif">2.2.1.Top level
	framework</FONT></H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>This
	manages the main application window, application level menus etc,
	and is responsible for instantiating the views.</FONT></FONT></P>
	<H4 CLASS="western"><FONT FACE="Arial, sans-serif">2.2.2.Utilities</FONT></H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>These
	constitute a small set of reusable helper classes – since they are
	used by more than one other class they are outside of the main tree
	of MVC elements.</FONT></FONT></P>
	<P CLASS="western"><BR><BR>
	</P>
	<H2 CLASS="western"><FONT FACE="Arial, sans-serif">3.Detailed
	descriptions of these elements</FONT></H2>
	<H3 CLASS="western">3.1.The Model</H3>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Although
	the primary copy of the currently loaded project is stored in
	libIntegra, a replica of these data is maintained in the GUI.  This
	'internal model' stores the state of the project in AS3 classes, and
	can be queried by views and the controller.  All source files
	relating to the model are located in the source tree under the
	directory src/components/model/.</FONT></FONT></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	model consists of the following classes:</FONT></FONT></P>
	<H4 CLASS="western">3.1.1.IntegraModel</H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>IntegraModel</I>
	is a top-level 'container' for the current state of the model.  It
	is implemented as a singleton with a static 'getter', so is
	accessible from anywhere in the application.  </FONT></FONT>
	</P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>IntegraModel</I>
	provides a set of query methods, for example retrieving objects by
	their Ids, and more complicated query methods eg determining whether
	a connection can be made without causing a feedback loop.</FONT></FONT></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>It
	also provides some modification methods – eg <I>clearModel</I>,
	<I>addDataObject</I>, <I>removeDataObject</I>.  These modifications
	methods are never called directly by views – they are only used
	within the 'controller' (ie by commands).</FONT></FONT></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	private data stored in <I>IntegraModel</I> is as follows:</FONT></FONT></P>
	<UL>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
		currently loaded project, as an instance of type </FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>Project.</I></FONT></FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>libIntegra
		data which cannot change during the application's runtime lifecycle
		(the list of libIntegra classes, and a map of libIntegra class
		names to class definitions)</FONT></FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>A
		'project dirty flag' to indicate whether the project has changed
		since it was last saved</FONT></FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>A
		state index (incremented every time the project state changes, used
		to handle updates from libIntegra)</FONT></FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>A
		map of ids to </FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>IntegraDataObjects.</I></FONT></FONT></P>
	</UL>
	<H4 CLASS="western">3.1.2.IntegraDataObject and derived classes</H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">All
	instantiable data objects are represented in IntegraLive GUI's
	internal data model as subclasses of </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>IntegraDataObject.
	 </I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">However,
	there isn't quite a one to one mapping between the classes used in
	IntegraLive GUI and the set of libIntegra classes.  There are two
	reasons for this:</SPAN></FONT></FONT></P>
	<OL>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">IntegraLive
		GUI uses the libIntegra class </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>Container</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		in a gui-specific way; it always treats the top-level container as
		the 'project', treats 2</SPAN></FONT></FONT><SUP><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">nd</SPAN></FONT></FONT></SUP><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		level containers as 'tracks' and 3</SPAN></FONT></FONT><SUP><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">rd</SPAN></FONT></FONT></SUP><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		level containers as 'blocks'.  These concepts 'project', 'track'
		and 'block' have no meaning for libIntegra – they are merely
		implementation details of the IntegraLive GUI.  But it's useful for
		the GUI to have separate classes to represent them in it's internal
		model, since it performs different operations on them.</SPAN></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>LibIntegra
		has two types of class: 'system' classes and 'non-system classes'.
		System classes are assumed to always exist by the GUI – it needs
		to make hardcoded assumptions about their existence, attributes and
		behaviour because they provide the gui's core functionality. 
		LibIntegra's system classes are: <I>Container, Connection, Player,
		Script, Envelope, ControlPoint</I>.  These are all represented
		explicitly in the GUI by their own class (with three subclasses for
		Container as described above).  </FONT></FONT>
		</P>
	</OL>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>In
	contrast, non-system classes can be added and removed from
	libIntegra without any requirement to make changes to the GUI,
	because they are all represented in the GUI by the single class
	<I>ModuleInstance</I>.</FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	following inheritance diagram illustrates the set of classes in
	IntegraLive GUI which inherit from <I>IntegraDataObject</I>, and
	shows which libIntegra classes they store data for:</FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><IMG SRC="Documentation%20of%20Integra%20Live%20GUI_html_m2565edef.gif" NAME="Object2" ALIGN=LEFT WIDTH=756 HEIGHT=533><BR CLEAR=LEFT><BR><BR>
	</P>
	<H4 CLASS="western">3.1.3.Identification of Data Objects</H4>
	<H5 CLASS="western"><FONT FACE="Arial, sans-serif">3.1.3.1.Identification
	within the XMLRPC API</FONT></H5>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Within
	the GUI ↔ libIntegra communication, all objects are identified by
	dot-connected strings containing their own names, preceded by the
	chain of names of their ancestors.</FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>For
	example, an object of type 'Connection' whose parent is an object of
	type 'Container' is identified as “&lt;container name&gt;.&lt;connection
	name”.    </FONT></FONT>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Each
	object must have a unique name within its set of siblings, whilst
	objects with different parents can have the same name.  Therefore
	this concatenated notation is the minimum identification system
	sufficient to uniquely identity objects.</FONT></FONT></P>
	<H5 CLASS="western"><FONT FACE="Arial, sans-serif">3.1.3.2.Internal
	identification in IntegraLive GUI</FONT></H5>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>IntegraLive
	GUI has its own system to identify data objects using positive
	integers which are allocated by the method
	<I>IntegraModel.generateNewID()</I> each time a new object is
	created.  The advantages of this system are twofold:</FONT></FONT></P>
	<OL>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Objects
		sometimes refer to each other (the class <I>Connection</I> refers
		to it's 'source' and 'target' objects, and some fields in user data
		refer to objects, in order to store information about selection
		state and live view controls).  Objects' names can change at
		runtime, and objects can be moved from one parent to another – in
		both cases changing the identification which would be used within
		the XMLRPC API.  These processes are simplified by having a 'fixed'
		id, which doesn't change during the lifecycle of the object's
		representation withing the gui.</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Objects
		in the gui can be retrieved efficiently using a map.  Integer ids
		are more efficient map keys due to their small size.</FONT></FONT></P>
	</OL>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>IntegraLive
	GUI always uses positive numbers for IDs, and by convention uses the
	value -1 to signify 'not an object' (this convention would is used
	where functions return an object's ID when the object cannot be
	found, or as a value to store for an ID where no object is referred
	to).</FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	class <I>IntegraModel</I> provides a set of methods to convert
	between internal IDs and “paths”, as well as methods to look
	objects up by their ids.  It also provides type-safe object
	retrieval methods (<I>getModuleInstance / getConnection </I>etc) –
	in practice these are used wherever possible as a more defensive 
	way to retrieve objects.</FONT></FONT></P>
	<H4 CLASS="western">3.1.4.User Data</H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>IntegraLive
	GUI stores some extra information which is only relevant to this
	GUI.  The mechanism by which this is persisted consists of a string
	attribute on every data object, which is stored 'blindly' by
	libIntegra (that is to say that libIntegra persists this attribute
	but has no idea what it does).  IntegraLive GUI uses this string to
	store XML, which contains sets of object-specific information.</FONT></FONT></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>All
	the classes relating to UserData are located in the source tree
	under the directory src/components/model/userData.</FONT></FONT></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>There
	is a bass class called <I>UserData</I>, which stores user data which
	is relevant to most types of <I>IntegraDataObject</I>: currently
	this is simply data about which objects are selected.</FONT></FONT></P>
	<H5 CLASS="western">3.1.4.1.Selection</H5>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>There
	are two types of selection in IntegraLive GUI – primary selection
	(which can only be held by one object in each group of siblings) and
	multiple selection (which can be held by an arbitrary number of
	objects).  Generally this distinction allows a mix of operations on
	multiple objects (such as mass deletions or parallel moves), and
	operations on single objects (such as opening them).  Typically
	multiple selection is indicated with background colour and primary
	selection is indicated with border weight.</FONT></FONT></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Not
	all types of objects actually feature both types of selection in the
	views, but both types are supported for all data objects in the
	model, through the common <I>UserData</I> class.  <I>UserData</I>
	has a boolean field <I>isSelected</I> to represent whether the
	object is in a multiple selection set, and a ID field
	<I>primarySelectedChildID</I> to represent the primary selected
	object within the object's children.</FONT></FONT></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	actual implementation of these types of selection for each type of
	object is as follows:</FONT></FONT></P>
	<TABLE WIDTH=100% BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0>
		<COL WIDTH=85*>
		<COL WIDTH=85*>
		<COL WIDTH=85*>
		<TR VALIGN=TOP>
			<TH WIDTH=33%>
				<P CLASS="western">Object 
				</P>
			</TH>
			<TH WIDTH=33%>
				<P CLASS="western">Has Primary Selection</P>
			</TH>
			<TH WIDTH=33%>
				<P CLASS="western">Has Multiple Selection</P>
			</TH>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Project</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>No</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>No</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Player</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>No</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>No</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Track</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Yes</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>No</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Block</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Yes</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Yes</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Module Instance</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Yes</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Yes</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Script</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Yes</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>No</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Connection</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>No</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Yes</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Scene</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Yes</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>No</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Envelope</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Yes</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>No</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Control Point</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>No</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>No</P>
			</TD>
		</TR>
	</TABLE>
	<P CLASS="western"><BR><BR>
	</P>
	<H5 CLASS="western">3.1.4.2.Specific User Data Classes</H5>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>There
	are a set of classes which inherit from <I>UserData</I>, and act as
	containers for extra data which is only needed for certain types of
	object.  These types of object customise the user data class they
	use by calling the protected 'setter' defined in <I>IntegraDataObject</I>
	from their constructor.</FONT></FONT></P>
	<H6 CLASS="western">3.1.4.2.1.ProjectUserData</H6>
	<P CLASS="western"> <FONT FACE="Arial, sans-serif"><FONT SIZE=2>Project
	User Data stores project-level GUI-specific attributes: View Mode,
	Timeline State, Color Scheme, and the set of Scenes.</FONT></FONT></P>
	<H6 CLASS="western">3.1.4.2.2.TrackUserData</H6>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Track
	User Data stores the colour of each track, the height it should be
	displayed in in the Arrange View, and whether it is expanded in the
	Arrange and Live views.</FONT></FONT></P>
	<H6 CLASS="western">3.1.4.2.3.BlockUserData</H6>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Block
	User Data stores the layout of modules in the Module Graph, and the
	set of live view controls to be displayed for the Block.</FONT></FONT></P>
	<H5 CLASS="western">3.1.4.3.'Leaf' User Data Classes</H5>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>These
	are a handful of classes which are referred to by these user data
	classes: </FONT></FONT>
	</P>
	<OL>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ColorScheme
		</I>is a simple enumeration class.</FONT></FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>LiveViewControl</I>
		stores information about each control to display in the Live View.</FONT></FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>Scene</I>
		stores information about each scene.</FONT></FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>TimelineState</I>
		stores the zoom and scroll postion of the timeline</FONT></FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ViewMode</I>
		represents the currently selected view: Arrange vs Live, and
		whether block properties are open.</FONT></FONT></P>
	</OL>
	<P CLASS="western"><BR><BR>
	</P>
	<P CLASS="western"><BR><BR>
	</P>
	<H4 CLASS="western">3.1.5.Model Loader</H4>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	class <I>ModelLoader </I>is responsible for loading all the contents
	of the model from libIntegra.  </FONT></FONT>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>It
	does this in a set of discrete phases, each of which consists of a
	set of XMLRPC calls.  It waits for each phase to complete before
	beginning the next phases, by tracking the number of outstanding
	XMLRPC calls.  This is necessary because some parts of the data need
	to be retrieved before the next sequence of calls can be made (for
	example it cannot query the attributes of objects until the set of
	existing objects has been received).</FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	classes relating to <I>ModelLoader </I>are located in the source
	tree under the directory src/components/model/modelLoader.</FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><FONT FACE="Arial, sans-serif">The
	model is loaded from scratch whenever the user selects the 'new
	project' or 'open project' menu commands.  </FONT><I>ModelLoader </I>is
	also reused by the 'import' commands (<I>ImportTrack, ImportBlock</I>,
	<I>ImportModule</I>) because unlike most commands, these cannot
	predict their own result.  This detail will be discussed in more
	detail in the section on controller commands.</FONT></FONT></P>
	<H5 CLASS="western">3.1.5.1.Extraneous Nodes</H5>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	IntegraLive GUI expects libIntegra projects to contain an object
	tree which is meaningful to the gui (for example it only expects to
	find a single object of type container at the top level of the
	object tree, and only expects to find objects of certain types at
	certain levels of the tree underneath this.  When <I>ModelLoader
	</I>encounters any objects which do not match its expectations, it
	calls the function <I>ModelLoader.foundExtraneousNode</I>().  This
	function traces the path of the unexpected node, as a stub for a
	possible future enhanced handling of this situation.  </FONT></FONT>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Note
	that at present extraneous nodes are not an expected occurrence,
	since IntegraLive GUI is the only available GUI for libIntegra. 
	However if alternative GUIs are developed is is likely that they
	could create different types of object tree (for example they might
	have no concepts such as 'Track' or 'Block').  In this instance it
	would be desirable to enhance IntegraLive GUI to implement some form
	of tree rotation such that any conceivable configuration of object
	tree can be massaged into a shape which is meaningful for this GUI,
	in order to facilitate cross-application interchangeability.</FONT></FONT></P>
	<H5 CLASS="western">3.1.5.2.Creation of default new project objects</H5>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>On
	completion of loading the model,<I> ModelLoader </I>creates
	mandatory default 'new project' objects if these are not already
	present.  These are: </FONT></FONT>
	</P>
	<OL>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
		Project.  This is a top level container object, which is required
		for IntegraLive GUI, although not for libIntegra</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
		Project Player.  This is an object of type 'Player' and is created
		directly under the project.</FONT></FONT></P>
	</OL>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>When
	<I>ModelLoader </I>detects that these objects are not present, it
	creates them, and dispatches a message to the controller, telling to
	create the non-mandatory default 'new project' objects (an initial
	track containing an initial block, containing initial input and
	output modules).  These non-mandatory objects are not created
	directly by <I>ModelLoader</I>, because normal command classes exist
	to create them, so this code can be reused by delegating the task to
	the Controller.</FONT></FONT></P>
	<H5 CLASS="western">3.1.5.3.ControlPositionLoader</H5>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	class <I>ControlPositionLoader </I>is instantiated and invoked by
	<I>ModelLoader </I>once for each <I>ModuleDefinition.  </I>It looks
	for an xml file for each non-system libIntegra class, and reads
	control layout information from any such files it finds.  This is
	explained more fully in the following section “Module Control
	Layouts”.</FONT></FONT></P>
	<H4 CLASS="western">3.1.6.Non-instantiable Model Components</H4>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>As
	well as the object types discussed above, which store elements
	within the object tree, <I>IntegraModel</I> represents information
	which does not change during libIntegra's execution lifecycle.  This
	is information about the different types of class available in
	LibIntegra for instantiation, as well as GUI-specific derived
	information about controls.</FONT></FONT></P>
	<H5 CLASS="western">3.1.6.1.ClassDefinition</H5>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	class <I>ClassDefinition</I> stores information about class types,
	in particular an array of AttributeDefinitions, each describing the
	properties of each of a class's attributes.  <I>ClassDefinition</I>
	objects are assembled for each type of system class, and
	<I>IntegraModel</I> stores a map of class names to their
	ClassDefinition.</FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Note
	that (as discussed above) system classes and their nature are
	assumed as fixed by the GUI – it needs to make hard-coded
	assumptions about their attributes because they provide the gui's
	core functionality, so the information in their runtime
	ClassDefinitions as downloaded from libIntegra is duplicated by
	hardcoded references to attributes.  However the information in the
	ClassDefinitions does allow their attribute values to be queried by
	<I>ModelLoader</I> in an abtracted manner, saving repetitive code
	for this task.</FONT></FONT></P>
	<H5 CLASS="western">3.1.6.2.ModuleDefinition</H5>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	class <I>ModuleDefinition</I> inherits from <I>ClassDefinition</I>,
	and is used to store class information about non-system classes.  It
	adds to <I>ClassDefinition</I> information about a module's inputs
	and outputs, as well as an array of Control Definitions for the
	module.</FONT></FONT></P>
	<H5 CLASS="western">3.1.6.3.ControlDefinition</H5>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	class <I>ControlDefinition</I> describes which controls should be
	available for a module.  There is a one-to-many relationship between
	controls and attributes – many controls are connected to only one
	attribute but it is also possible for a single control to control
	many attributes.  The mapping is not directly provided by
	libIntegra, rather it is referred from the attribute definition by
	<I>ModelLoader</I>, with default behaviours for modules which do not
	define any controls to use.  </FONT></FONT>
	</P>
	<H5 CLASS="western">3.1.6.4.Module Control Layouts</H5>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ControlDefinition</I>
	also stores information about how controls should be laid out in the
	Module Properties view – this information is not currently
	provided by the server, but is loaded from a set of optional xml
	files located in &lt;applicationDirectory&gt;/ModuleControlLayouts/
	by the class <I>ControlPositionLoader</I>.  </FONT></FONT>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>These
	xml files are currently created by a standalone flash utility
	application called ModuleLayoutEditor, which is located in the
	source tree under integralive/database/trunk/ModuleLayoutEditor, 
	There is a plan to eventually integrate this editor into the module
	definition gui in to web backend, at which point control layouts
	could be included within libIntegra and the XMLRPC API, and loaded
	along with all the other non-instantiable  Model Components.</FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<H3 CLASS="western">3.2.The Controller 
	</H3>
	<P CLASS="western" STYLE="margin-bottom: 0cm">The 'Controller' part
	of IntegraLive GUI's MVC consists of a set of 'command' classes,
	each of which stores data to manage a single operation, and contains
	code to apply the operation to the internal model and libIntegra via
	the XMLRPC API.</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm">It also contains:</P>
	<UL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm"><I>IntegraController</I>,
		a singleton manager class which is the entry point for processing
		of commands.</P>
		<P CLASS="western" STYLE="margin-bottom: 0cm"></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm">Classes relating
		to the undo/redo stack.</P>
		<P CLASS="western" STYLE="margin-bottom: 0cm"></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm"><I>UpdateReceiver</I>
		– a class which handles externally-instantiated changes to
		libIntegra's state, and applies them to IntegraLive GUI's internal
		model and views.</P>
	</UL>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<UL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm">A set of event
		classes, which implement communication from the controller to the
		views and application framework.</P>
		<P CLASS="western" STYLE="margin-bottom: 0cm"></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm">File I/O classes,
		to handle loading and saving directly from IntegraLive GUI to xml
		files.  These classes are now deprecated – they were used before
		loading and saving was implemented in libIntegra, and are no longer
		needed.</P>
	</UL>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>All
	source files relating to the controller are located in the source
	tree under the directory src/components/controller/.</FONT></FONT></P>
	<UL>
		<P CLASS="western" STYLE="margin-bottom: 0cm"></P>
	</UL>
	<H4 CLASS="western">3.2.1.IntegraController</H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>IntegraController</I>
	is implemented as a singleton with a static 'getter', so is
	accessible from anywhere in the application.  In practice it is
	never referred to from any part of the model. but is used by views
	everywhere where they need to apply changes to the model.</FONT></FONT></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>IntegraController</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2>
	contains a public method </FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>processCommand(
	&lt;command&gt; )</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2>.
	 This is the entry point for all such changes to the model – views
	instantiate commands and pass them into
	</FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>IntegraController.processCommand.</I></FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>IntegraController
	</I>also contains public methods relating to the lifecycle of a
	project (new, load, save etc), and relating to the undostack
	(<I>canUndo, canRedo, undo, redo</I>).</FONT></FONT></P>
	<H4 CLASS="western">3.2.2.Command Classes</H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>All
	command classes inherit from either of the classes <I>ServerCommand</I>
	or <I>UserDataCommand</I>, which in turn both inherit from the class
	<I>Command</I>, as illustrated in the following inheritance diagram:</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><IMG SRC="Documentation%20of%20Integra%20Live%20GUI_html_64a4de70.gif" NAME="Object3" ALIGN=LEFT WIDTH=504 HEIGHT=355><BR CLEAR=LEFT>The
	each command class has private variables to store any data specific
	to the operation it represents.  These variables are passed into,
	and initialized by the command's constructor.  For example, the
	command <I>SetTrackColor </I>stores private variables track ID and
	colour.  
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm">The base classes for
	command classes define virtual functions, which are called by
	<I>IntegraController.processCommand</I>, and implemented by concrete
	command classes.  This allows <I>IntegraController </I>to handle
	command classes with no specific knowledge of their details.  
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm">Concrete classes do
	not typically need to override all the available virtual functions,
	only those that are relevent to them.</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"> 
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm">The virtual functions
	defined in <I>Command </I><SPAN STYLE="font-style: normal">are as
	follows:</SPAN></P>
	<TABLE WIDTH=857 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0>
		<COL WIDTH=262>
		<COL WIDTH=573>
		<TR VALIGN=TOP>
			<TD WIDTH=262>
				<P CLASS="western" ALIGN=CENTER><B>Function name</B></P>
			</TD>
			<TD WIDTH=573>
				<P CLASS="western" ALIGN=CENTER><B>Purpose</B></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=262>
				<P CLASS="western"><I>initialize()</I></P>
			</TD>
			<TD WIDTH=573>
				<P CLASS="western">Implement <I>initialize()</I> for two reasons:</P>
				<P CLASS="western"><BR>
				</P>
				<P CLASS="western">1) to initialize any members whose initial
				values are not always specified by the sender of the command.</P>
				<P CLASS="western">			</P>
				<P CLASS="western">2) to return false and reject the command if
				the parameters are invalid or if the command would do nothing (ie
				replace a value with the same value.</P>
				<P CLASS="western"><BR>
				</P>
				<P CLASS="western">Note that initialize is only called for
				commands that are instantiated by views.  They are not called
				when commands are executed from the undo/redo stack.  The
				implication of this is that inverse commands should not rely on
				initialize to initialize default values – they should all be
				provided in advance.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=262>
				<P CLASS="western"><I>generateInverse()</I></P>
			</TD>
			<TD WIDTH=573>
				<P CLASS="western">Implement <I>generateInverse()</I> to make
				successive (typically 1) calls to <I>pushInverseCommand </I>with
				a set of commands	which do the exact opposite of this command. 
				This is how the undo/redo functionality is implemented – each
				command defines its opposite, and the opposite can be executed to
				revert the project to its previous state.  The original command
				is also retained to be reexecuted to apply redo if necessary.</P>
				<P CLASS="western"><BR>
				</P>
				<P CLASS="western">For example, a the command <I>AddBlock</I>
				implements generateInverse by calling <I>pushInverseCommand( new
				RemoveBlock( _blockID ) )</I></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=262>
				<P CLASS="western"><I>preChain()</I></P>
			</TD>
			<TD WIDTH=573>
				<P CLASS="western">Implement <I>preChain()</I> when a command
				needs to execute other commands before executing itself (for
				example removing connections before removing a module).  This is
				a mechanism to construct 'cascading' commands, in order to reuse
				existing functionality when one operation constitutes a subset of
				another operation.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=262>
				<P CLASS="western"><I>execute()</I></P>
			</TD>
			<TD WIDTH=573>
				<P CLASS="western">Implement <I>execute()</I> to update the
				internal model from previous state to new state according to this
				command.  This is the 'meat' of the command, and will generally
				need to be implemented for every concrete command class.</P>
				<P CLASS="western"><BR>
				</P>
				<P CLASS="western">The <I>execute()</I><SPAN STYLE="font-style: normal">
				methods of command classes are the only place where data in the
				internal model should be directly written to.</SPAN></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=262>
				<P CLASS="western"><I>postChain()</I></P>
			</TD>
			<TD WIDTH=573>
				<P CLASS="western">Implement <I>postChain()</I> when a command
				needs to execute other commands after executing itself (for
				example selecting an object after it was created).  Like
				<I>preChain()</I><SPAN STYLE="font-style: normal"> this method
				allows construction of 'cascading' commands in order to reuse
				existing functionality when one operation constitutes a subset of
				another operation.</SPAN></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=262>
				<P CLASS="western"><I>canReplacePreviousCommand()</I></P>
			</TD>
			<TD WIDTH=573>
				<P CLASS="western">Implement <I>canReplacePreviousCommand</I> for
				commands which replace a value, to minimise size of transactions
				in which a single value changes many times. 
				<I>canReplacePreviousCommand</I> must only return true when the
				effect of the previous command is entirely replaced by the effect
				of this command (eg setting the same attribute of the same module
				instance).</P>
			</TD>
		</TR>
	</TABLE>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<H5 CLASS="western" STYLE="font-style: normal">3.2.2.1.ServerCommand</H5>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><SPAN STYLE="font-style: normal">In
	addition to these methods, commands which inherit from
	</SPAN><I>ServerCommand</I><SPAN STYLE="font-style: normal">, and
	thus affect libIntegra (as opposed to merely affecting GUI-specific
	user data) can override the following functions, defined in
	</SPAN><I>ServerCommand</I><SPAN STYLE="font-style: normal">:</SPAN></P>
	<TABLE WIDTH=857 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0>
		<COL WIDTH=262>
		<COL WIDTH=573>
		<TR VALIGN=TOP>
			<TD WIDTH=262>
				<P CLASS="western"><I>executeServerCommand()</I></P>
			</TD>
			<TD WIDTH=573>
				<P CLASS="western">Implement <I>executeServerCommand</I><SPAN STYLE="font-style: normal">
				to actually send the XMLRPC command to the server.</SPAN></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=262>
				<P CLASS="western"><I>testServerResponse()</I></P>
			</TD>
			<TD WIDTH=573>
				<P CLASS="western">Implement <I>testServerResponse </I>to check
				whether the libIntegra command has executed as expected.  Return
				false if the command does not appear to have executed
				successfully.</P>
			</TD>
		</TR>
	</TABLE>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><SPAN STYLE="font-style: normal">Note
	that there isn't a one-to-one mapping between concrete
	implementations of </SPAN><I>ServerCommand</I><SPAN STYLE="font-style: normal">
	and commands in the XMLRPC API.  </SPAN>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><SPAN STYLE="font-style: normal">In
	general, there are more Server Commands in the GUI, and often
	multiple Server Commands use the same XMLRPC API command internally.
	 For example the Server Commands </SPAN><I>SetModuleAttribute </I><SPAN STYLE="font-style: normal">and
	</SPAN><I>SetPlayPosition </I><SPAN STYLE="font-style: normal">both
	use the same XMLRPC API command 'set'.</SPAN></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><SPAN STYLE="font-style: normal">Additionally,
	many Server Commands use more than one XMLRPC API command in their
	implementation.  They do this by using the XMLRPC 'multicall'
	notation, to send an array of commands.  For example the Server
	Command A</SPAN><I>ddBlock </I><SPAN STYLE="font-style: normal">sends
	'new' commands to libIntegra to instantiate a container, and an
	envelope next to it (to control the block's 'active' attribute), and
	a connection to connect the envelope to the block, and control
	points to the block envelope, and also sends 'set' commands to
	libIntegra to perform all necessary initialisation on the attributes
	of these new objects.</SPAN></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><SPAN STYLE="font-style: normal">Concrete
	implementations of </SPAN><I>ServerCommand </I><SPAN STYLE="font-style: normal">are
	all located </SPAN><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">in
	the source tree under the directory
	src/components/controller/serverCommands.</SPAN></FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<H5 CLASS="western">3.2.2.2.UserDataCommand</H5>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><SPAN STYLE="font-style: normal">Commands
	which inherit from </SPAN><I>UserDataCommand</I><SPAN STYLE="font-style: normal">,
	and thus only affect the “userData” attribute of data objects
	can override the following function, defined in </SPAN><I>UserDataCommand</I><SPAN STYLE="font-style: normal">:</SPAN></P>
	<TABLE WIDTH=857 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0>
		<COL WIDTH=312>
		<COL WIDTH=524>
		<TR VALIGN=TOP>
			<TD WIDTH=312>
				<P CLASS="western"><I>getObjectsWhoseUserDataIsAffected()</I></P>
			</TD>
			<TD WIDTH=524>
				<P CLASS="western" STYLE="font-style: normal">Override this
				function to fill a vector with the IDs of all objects whose
				userData was changed by the command.  This allows
				IntegraController to automate the process of propagating the xml
				string representation of each object's userData up to libIntegra,
				whilst efficiently only dealing with objects whose userData might
				have changed.</P>
			</TD>
		</TR>
	</TABLE>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><SPAN STYLE="font-style: normal">Additionally,
	</SPAN><I>UserDataCommand</I><SPAN STYLE="font-style: normal">
	provides protected helper functions to implement 'utility-type'
	functionality that is needed by more than one concrete User Data
	Command.</SPAN></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><SPAN STYLE="font-style: normal">Concrete
	implementations of </SPAN><I>UserDataCommand </I><SPAN STYLE="font-style: normal">are
	all located </SPAN><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">in
	the source tree under the directory
	src/components/controller/userCommands.</SPAN></FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<H5 CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=3>3.2.2.3.Undo/Redo
	Stack</FONT></FONT></H5>
	<P CLASS="western" STYLE="margin-bottom: 0cm">The Undo/Redo stack
	consists of the classes <I>UndoManager</I> and <I>Transaction</I><SPAN STYLE="font-style: normal">,
	both of which are located </SPAN><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">in
	the source tree under the directory
	src/components/controller/undostack.</SPAN></FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">Transactions
	are vectors of commands, each of which contain vectors of 'inverse
	commands', and the undo manager stores a vector of transactions for
	the undo stack, and a separate vector of transactions for the redo
	stack.  These transactions are applied by </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>UndoManager</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">,
	which iterates through the constituent commands, passing them to an
	'inner process method' supplied by </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>IntegraController</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">.
	 This inner process method calls the commands' virtual functions
	</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>execute</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">,
	and </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>executeServerCommand</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">,
	and updates views accordingly, but does not call </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>initialize,
	preChain </I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">or
	</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>postChain</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">.</SPAN></FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	undo manager is only accessed directly by <I>IntegraController</I>,
	which encapsulates its functionality and presents a simple set of
	undo-related public methods to the application framework.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	concept of 'transactions' is necessary because when the user clicks
	'undo' or 'redo' they expect these actions to relate to what
	conceptually feels like a single action, as opposed to undoing or
	redoing individual commands.  </FONT></FONT>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Commands
	can be concatenated into the same transaction for the following
	reasons:</FONT></FONT></P>
	<UL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">The
		command has been executed within the same message-processing cycle
		as another command (via the </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>Command.preChain</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		or </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>Command.postChain</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		mechanisms, or because a view called
		</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>IntegraController.processCommand()
		</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">twice
		with different commands within the same input event handler). 
		These cases are detected via an inactivity timer, implemented in
		</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>UndoManager.</I></FONT></FONT></P>
		<P CLASS="western" STYLE="margin-bottom: 0cm"></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal">
		<FONT FACE="Arial, sans-serif"><FONT SIZE=2>The command has been
		executed when the mouse has been captured by the application (ie a
		drag operation is in place), and a command has already been
		executed during the same drag operation.  This functionality is
		desirable because if the user performs a drag operation which sends
		a stream of commands to the server (eg repositioning playhead or
		dragging a module attribute's slider), and then chooses to undo
		this action, they expect a single undo to revert to the state
		before the entire drag operation, rather than having to choose
		'undo' many times to revert each step within the drag operation.</FONT></FONT></P>
		<P CLASS="western" STYLE="margin-bottom: 0cm"></P>
	</UL>
	<UL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">The
		command class itself has identified itself as not being a new undo
		step, by setting </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>isNewUndoStep
		= false</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		from it's constructor.  This causes the command to be </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>always</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		appended to the existing transaction, instead of constituting its
		own undo step.  Only very ephemeral commands such as
		</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>SetProjectModified</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		would actually do this.</SPAN></FONT></FONT></P>
	</UL>
	<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
	</P>
	<H5 CLASS="western">3.2.2.4.UpdateReceiver</H5>
	<P CLASS="western">The class <I>UpdateReceiver</I><SPAN STYLE="font-style: normal">
	is in charge of updating IntegraLive GUI when libIntegra's state
	changes for some external reason.  There are various reasons why
	this could happen:</SPAN></P>
	<OL>
		<LI><P CLASS="western" STYLE="font-style: normal">Modules changing
		their own attribute (eg Player's play position, or Audio Input's vu
		meter).</P>
		<LI><P CLASS="western" STYLE="font-style: normal">libIntegra's
		implementation of connections between attributes – one attribute
		changing because it is the target of a connection from another
		attribute whose value has changed.</P>
		<LI><P CLASS="western" STYLE="font-style: normal">Commands from the
		scripting engine.</P>
	</OL>
	<P CLASS="western"><I>UpdateReceiver </I><SPAN STYLE="font-style: normal">works
	by making repeated calls to the XMLRPC API function 'updates',
	passing in a state index referring to the last state known by the
	GUI.  This 'updates' function is implemented by libIntegra as a
	delayed-response function – it doesn't return until at least one
	command has executed.  The GUI also waits for a response to each
	call to 'updates' before making any subsequent calls.</SPAN></P>
	<P CLASS="western"><SPAN STYLE="font-style: normal">On receipt of a
	response from an 'updates' call, UpdateReceiver examines the
	response (an array of XMLRPC API commands) and attempts to construct
	an ephemeral </SPAN><I>ServerCommand-</I><SPAN STYLE="font-style: normal">derived
	class from each XMLRPC API command.  These constructed Server
	Commands are not fed through IntegraController in the usual way,
	because they are not commands emanating from views, and shouldn't be
	pushed unto the undo stack or sent back to the server.  Rather,
	their execute methods are invoked (to update the GUI's internal
	model), and they are dispatched in an IntegraCommandEvent, to signal
	any views to update.</SPAN></P>
	<P CLASS="western" STYLE="font-style: normal">This approach has the
	advantage that views' updating code is encapsulated from the reason
	a command happened, eg if the play position has moved, a view can
	use the same code to update it's appearance regardless of whether
	the change came from libIntegra or a different view.</P>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<P CLASS="western"><SPAN STYLE="font-style: normal">Note: at
	present, external actions can only change object's attribute values.
	 They cannot create or delete objects.  Consequentially,
	</SPAN><I>UpdateReceiver </I><SPAN STYLE="font-style: normal">only
	handles XMLRPC API 'set' commands.  Also, it doesn't handle all
	conceivable 'set' commands, only the ones it expects to encounter. 
	The implementation of UpdateReceiver may need to be expanded in
	future, but hopefully the overall architecture of the system can be
	retained and built upon.</SPAN></P>
	<H5 CLASS="western" STYLE="font-style: normal">3.2.2.5.Controller
	Event Classes</H5>
	<P CLASS="western"><SPAN STYLE="font-style: normal">The controller
	notifies views and the application framework about changes to the
	state of the Internal Model by dispatching actionscript Event
	Classes.  There are a set of custom event classes, all of which are
	located in </SPAN><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">the
	source tree under the directory src/components/controller/events.</SPAN></FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	set of controller event classes are as follows:</FONT></FONT></P>
	<TABLE WIDTH=857 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0>
		<COL WIDTH=313>
		<COL WIDTH=522>
		<TR VALIGN=TOP>
			<TD WIDTH=313>
				<P CLASS="western"><I>AllDataChangedEvent</I></P>
			</TD>
			<TD WIDTH=522>
				<P CLASS="western">Dispatched when data has been reloaded from
				the server in it's entirety.  Instructs views to update their
				state from scratch.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=313>
				<P CLASS="western"><I>IntegraCommandEvent</I></P>
			</TD>
			<TD WIDTH=522>
				<P CLASS="western">Dispatched when a command has executed. 
				Stores a reference to the command as a member variable, and
				allows views to perform light, context-specific updates by
				interrogating the command which has occurred and only updating as
				much as necessary.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=313>
				<P CLASS="western"><I>ImportEvent</I></P>
			</TD>
			<TD WIDTH=522>
				<P CLASS="western">Dispatched on start &amp; end of import
				processes – intercepted by the application framework to put the
				application into a modal state whilst the import process is
				underway, and end the modal state on completion.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=313>
				<P CLASS="western"><I>CreateDefaultNewProjectObjectsEvent</I></P>
			</TD>
			<TD WIDTH=522>
				<P CLASS="western">Dispatched on completion of reloading the data
				from the server, in cases where non-mandatory new objects need to
				be created (see section on “Creation of default new project
				objects” above),</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=313>
				<P CLASS="western"><I>ReloadAllDataEvent</I></P>
			</TD>
			<TD WIDTH=522>
				<P CLASS="western">Dispatched when all data needs to be reloaded,
				for example as a failsafe mechanism when a serious error is
				detected.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=313>
				<P CLASS="western"><I>ServerTimeOutEvent</I></P>
			</TD>
			<TD WIDTH=522>
				<P CLASS="western">Dispatched when the server has timed out, to
				instruct the application framework to display a 'server timeout'
				error, and close.</P>
			</TD>
		</TR>
	</TABLE>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<H5 CLASS="western">3.2.2.6.Importing data objects from disk (Tracks
	/ Blocks / Modules )</H5>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">The
	commands to import data objects from disk (</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ImportTrack</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">,
	</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ImportBlock</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
	and </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ImportModule</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">)
	are awkward because they break the normal order in which Server
	Commands are processed.  </SPAN></FONT></FONT>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Normally
	when IntegraController processes a Server Command, it dispatches the
	XMLRPC API call to the server, updates the internal model, and
	updates views within a single entry-point, and then only waits for
	the XMLRPC-API response to confirm that the result was as expected.</FONT></FONT></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">This
	approach only works because the effect on libIntegra's state of most
	XMLRPC-API commands is entirely predictable by the GUI – it
	essentially duplicates the same change within the Server Command's
	</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>execute</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
	function, and obtains an advance copy of what libIntegra's new state
	will be once the XMLRPC-API call has completed.</SPAN></FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>However,
	the effect of importing data objects is not predictable, because
	there is no code to load and interpret Integra XML Documents in the
	GUI.  So instead, the GUI dispatches the XMLRPC-API command, to
	initiate the loading, and then sends a special event to lock the GUI
	into a modal state (and prevent and subsequent commands from being
	executed) until libIntegra responds.  Then, it reuses functionality
	in ModelLoader to query libIntegra for the new state of it's object
	tree, and finally dispatches another special event to unlock the GUI
	and allow resumption of further commands.</FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<H3 CLASS="western">3.3.The Views 
	</H3>
	<P CLASS="western"> The 'Views' part of IntegraLive GUI's MVC
	consists of a set of 'view' classes, each of which inherits from the
	base class <I>IntegraView:</I></P>
	<P CLASS="western"><BR><BR>
	</P>
	<P CLASS="western"><IMG SRC="Documentation%20of%20Integra%20Live%20GUI_html_1333e7b6.gif" NAME="Object4" ALIGN=LEFT WIDTH=289 HEIGHT=347><BR CLEAR=LEFT><SPAN STYLE="font-style: normal">Each
	view displays a component of the GUI, querying </SPAN><I>IntegraModel</I><SPAN STYLE="font-style: normal">
	to know what to display, passing commands into </SPAN><I>IntegraController
	</I><SPAN STYLE="font-style: normal">to update the project's state,
	and responding to updates from </SPAN><I>IntegraController</I><SPAN STYLE="font-style: normal">
	when the state of the project has changed.</SPAN></P>
	<P CLASS="western" STYLE="font-style: normal">Views are instantiated
	in a hierarchical way, mimicking their physical positioning within
	the main application frame.  
	</P>
	<P CLASS="western"><SPAN STYLE="font-style: normal">Some views'
	lifecycles match the application's lifecycle
	(</SPAN><I>ArrangeView/ModuleGraph</I><SPAN STYLE="font-style: normal">
	etc), whilst some views' lifecycles match the lifecycles of
	individual data objects (</SPAN><I>ArrangeViewTrack, BlockView </I><SPAN STYLE="font-style: normal">etc).
	 These shorter-lived views are created and destroyed by their
	containing view, and occupy a subset of the same screenspace.  For
	example, instances of </SPAN><I>ArrangeViewTrack </I><SPAN STYLE="font-style: normal">are
	created and destroyed by </SPAN><I>ArrangeView, </I><SPAN STYLE="font-style: normal">and
	live 'inside' </SPAN><I>ArrangeView</I><SPAN STYLE="font-style: normal">,
	as owned child views.  In the most extreme example, </SPAN><I>BlockView</I><SPAN STYLE="font-style: normal">
	manages a set of overlapping </SPAN><I>EnvelopeView </I><SPAN STYLE="font-style: normal">instances</SPAN><I>,
	</I><SPAN STYLE="font-style: normal">one for each envelope that
	exists in the block.  These Envelope Views occupy the same space as
	each other – they are overlays.  </SPAN>
	</P>
	<P CLASS="western" STYLE="font-style: normal">In order to maintain
	encapsulation, views which own other views shouldn't tightly couple
	to them – they should be as ignorant as possible of the nature of
	the views they are managing, and should rely on the normal workings
	of the MVC for any actions which affect more than one view.</P>
	<P CLASS="western" STYLE="font-style: normal">The following diagram
	illustrates the tree of view instantiation and ownership, from the
	top level framework down:</P>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><IMG SRC="Documentation%20of%20Integra%20Live%20GUI_html_m390e479.gif" NAME="Object5" ALIGN=LEFT WIDTH=806 HEIGHT=560><BR CLEAR=LEFT><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm">Apart from view
	classes themselves, the 'views' part of the MVC also contains:</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<UL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm">A set of classes
		relating to presentation of views: <I>ViewHolder</I>, <I>ViewTree</I>
		and <I>IntegraViewEvent</I></P>
		<P CLASS="western" STYLE="margin-bottom: 0cm"></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm">A set of leaf GUI
		widget classes that are specific to the views that use them (not
		reused).</P>
		<P CLASS="western" STYLE="margin-bottom: 0cm"></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm">A set of 'skin'
		classes to customize the appearance of controls.</P>
		<P CLASS="western" STYLE="margin-bottom: 0cm"></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0cm"><I>MouseCapture –
		</I><SPAN STYLE="font-style: normal">a utility for tracking mouse
		movement, including off-application mouse movement, during drag
		operations.</SPAN></P>
	</UL>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>All
	source files relating to the views are located in the source tree
	under the directory src/components/views/.</FONT></FONT></P>
	<H4 CLASS="western"><I>3.3.1.IntegraView</I></H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>IntegraView
	</I><SPAN STYLE="font-style: normal">contains a set of virtual
	functions individual view classes can override, and public and
	protected functions views can call.  </SPAN></FONT></FONT>
	</P>
	<H5 CLASS="western">3.3.1.1.View updating functions</H5>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	following functions control the views' updating logic.</FONT></FONT></P>
	<TABLE WIDTH=100% BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0>
		<COL WIDTH=87*>
		<COL WIDTH=169*>
		<TR VALIGN=TOP>
			<TD WIDTH=34%>
				<P CLASS="western">virtual function <I>onAllDataChanged</I></P>
			</TD>
			<TD WIDTH=66%>
				<P CLASS="western">Implement this function to provide the view's
				“full update”.  This function should assume that the internal
				model has changed arbitrarily, and the view should update itself
				completely from scratch.  It is called when new projects are
				created or loaded, when views are created, and when views are
				revealed after a large number of commands occur when the view is
				hidden.  It is also called when the testing 'update all views' or
				'reload from backend and update all views' commands are invoked.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=34%>
				<P CLASS="western">function <I>addUpdateMethod</I></P>
				<P CLASS="western">        
				</P>
			</TD>
			<TD WIDTH=66%>
				<P CLASS="western">This function is called repeatedly from views'
				constructors to register command-specific update functions for
				all commands which can cause this view to need updating.  The
				implementation of these update functions can assume that the view
				was up to date before the function was called, so can perform a
				minimal 'smart update'.  
				</P>
			</TD>
		</TR>
	</TABLE>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Views
	do not receive any update calls when they are hidden; instead they
	are flagged as dirty, and receive an update call when they are
	revealed.  </FONT></FONT>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>However,
	since it is possible for a view to be hidden whilst its titlebar is
	not hidden (in the case of collapsed views), there is a separate
	system for identifying commands which can cause the titlebar
	contents to become invalid.  This system consists of a set of
	functions for registering command classes which can make the various
	elements of each view's titlebar become invalid:</FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<TABLE WIDTH=100% BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0>
		<COL WIDTH=105*>
		<COL WIDTH=151*>
		<TR VALIGN=TOP>
			<TD WIDTH=41%>
				<P CLASS="western">function <I>addTitleInvalidatingCommand</I></P>
			</TD>
			<TD WIDTH=59%>
				<P CLASS="western">This function is called repeatedly from views'
				constructors to register command classes which can cause the
				view's title to become invalid.  
				</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=41%>
				<P CLASS="western">function <I>addTitlebarInvalidatingCommand</I></P>
			</TD>
			<TD WIDTH=59%>
				<P CLASS="western">This function is called repeatedly from views'
				constructors to register command classes which can cause the
				view's titlebar view to become invalid.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=41%>
				<P CLASS="western">function <I>addVuMeterChangingCommand</I></P>
			</TD>
			<TD WIDTH=59%>
				<P CLASS="western">This function is called repeatedly from views'
				constructors to register command classes which can cause the
				view's vuMeter container ID to become invalid.  
				</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=41%>
				<P CLASS="western">function <I>addColorChangingCommand</I></P>
			</TD>
			<TD WIDTH=59%>
				<P CLASS="western">This function is called repeatedly from views'
				constructors to register command classes which can cause the
				view's colour to become invalid.</P>
			</TD>
		</TR>
	</TABLE>
	<P CLASS="western"><FONT SIZE=2><FONT FACE="Arial, sans-serif"><SPAN STYLE="font-style: normal">Note
	that IntegraView itself does not implement a titlebar; this
	functionality is provided by the class ViewHolder.  So these
	titlebar-related only need to be used by views which are
	instantiated within a </SPAN></FONT><FONT FACE="Arial, sans-serif"><I>ViewHolder.</I></FONT></FONT></P>
	<P CLASS="western"><BR><BR>
	</P>
	<H5 CLASS="western">3.3.1.2.Titlebar-related functions</H5>
	<P CLASS="western">The following table describes the role of
	IntegraView's virtual functions related to views' titlebars:  
	</P>
	<TABLE WIDTH=100% BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0>
		<COL WIDTH=82*>
		<COL WIDTH=174*>
		<TR VALIGN=TOP>
			<TD WIDTH=32%>
				<P CLASS="western">virtual getter <I>title</I></P>
			</TD>
			<TD WIDTH=68%>
				<P CLASS="western">Implement <SPAN STYLE="font-style: normal">to
				return the view's title – either a constant such as “Arrange
				View”, or a changeable value such as the name of a selected
				object.</SPAN></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=32%>
				<P CLASS="western">virtual setter <I>title</I></P>
			</TD>
			<TD WIDTH=68%>
				<P CLASS="western">Implement to allow views to process a command
				to rename an object <SPAN STYLE="font-style: normal">when the
				user uses a view's titlebar to provide a new object name.</SPAN></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=32%>
				<P CLASS="western">virtual getter <I>isTitleEditable</I></P>
			</TD>
			<TD WIDTH=68%>
				<P CLASS="western">Implement to allow views to specify whether
				their title should be readonly or read/write.  The virtual setter
				for <I>title</I> will never be called unless <I>isTitleEditable</I><SPAN STYLE="font-style: normal">
				returns true.</SPAN></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=32%>
				<P CLASS="western">virtual getter <I>titlebarView</I></P>
			</TD>
			<TD WIDTH=68%>
				<P CLASS="western">Implement to return a separate
				<I>IntegraView&shy;-</I><SPAN STYLE="font-style: normal">derived
				view instance to be used as a custom view embedded within this
				view's titlebar.  Such </SPAN><SPAN STYLE="font-style: normal">titlebar
				views are used in the titlebar for ArrangeViewProperties, which
				displays selected block's properties, or selected scene's
				properties, depending on current selection. </SPAN>
				</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=32%>
				<P CLASS="western">virtual getter <I>vuMeterContainerID</I></P>
			</TD>
			<TD WIDTH=68%>
				<P CLASS="western">Implement to return the ID of a Block, Track,
				or Project for which a vu meter should be displayed in the
				titlebar of this view.  This method is used for views such as
				<I>ModuleGraph, ArrangeViewTrack, LiveViewTrack, ArrangeView </I><SPAN STYLE="font-style: normal">and
				</SPAN><I>LiveView, </I><SPAN STYLE="font-style: normal">which
				display aggregate vu meters in their titlebars.</SPAN></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=32%>
				<P CLASS="western"><SPAN STYLE="font-style: normal">virtual
				getter </SPAN><I>color</I></P>
			</TD>
			<TD WIDTH=68%>
				<P CLASS="western" STYLE="font-style: normal">Implement to return
				the foreground colour for the view's titlebar (this colour will
				be used to display the collapse/expand button, title label and
				vuMeter).</P>
			</TD>
		</TR>
	</TABLE>
	<P CLASS="western">Note that IntegraView itself does not implement a
	titlebar; this functionality is provided by the class <I>ViewHolder.
	 </I><SPAN STYLE="font-style: normal">Therefore the titlebar-related
	functions will have no effect unless used from a view which is
	instantiated within a </SPAN><I>ViewHolder.</I></P>
	<H5 CLASS="western" STYLE="font-style: normal">3.3.1.3.Window size
	and state-related functions</H5>
	<P CLASS="western">The following table describes the role of
	IntegraView's functions related to views' size and state:  
	</P>
	<TABLE WIDTH=100% BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0>
		<COL WIDTH=94*>
		<COL WIDTH=162*>
		<TR VALIGN=TOP>
			<TD WIDTH=37%>
				<P CLASS="western">virtual function <I>resizeFinished</I></P>
			</TD>
			<TD WIDTH=63%>
				<P CLASS="western">Implement to allow views to process a command
				to store a view's size in user data<SPAN STYLE="font-style: normal">.</SPAN></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=37%>
				<P CLASS="western">virtual setter <I>collapsed</I></P>
			</TD>
			<TD WIDTH=63%>
				<P CLASS="western">Implement to allow views to process a command
				to store in user data the fact that the view's expand/collapse
				state has changed<SPAN STYLE="font-style: normal">.</SPAN></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=37%>
				<P CLASS="western">virtual getter <I>isSidebarColours</I></P>
			</TD>
			<TD WIDTH=63%>
				<P CLASS="western">Implement <SPAN STYLE="font-style: normal">to
				tell the IntegraView to render it's background with 'sidebar'
				appearance rather than as a “main content view”.  </SPAN>
				</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=37%>
				<P CLASS="western" STYLE="font-style: normal">setter <I>hintLabel</I></P>
			</TD>
			<TD WIDTH=63%>
				<P CLASS="western" STYLE="font-style: normal">Pass a string into
				this function to display a “newbie hint” (eg “double-click
				here to create a block”).  Pass null to remove the hint. 
				Typically views only display hints when they are empty – so
				when the user creates an object the hint disappears.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=37%>
				<P CLASS="western" STYLE="font-style: normal">setter
				<I>hintLabelVerticalCentre</I></P>
			</TD>
			<TD WIDTH=63%>
				<P CLASS="western" STYLE="font-style: normal">Pass a number into
				this function to alter the vertical centering of the hint.  This
				is only needed if the hint label's verical centering needs to be
				offset.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=37%>
				<P CLASS="western" STYLE="font-style: normal">setter
				contextMenuDataProvider</P>
			</TD>
			<TD WIDTH=63%>
				<P CLASS="western">Use this function to provide an array of
				objects specifying the view's context menu contents.  Each menu
				item object can contain a label, keyEquivalent, handler function
				(executed when the menu item is chosen), and updater function
				(executed to update the menu item's attributes such as
				checkstate, enabled etc before the menu is displayed).  
				</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=37%>
				<P CLASS="western" STYLE="font-style: normal">virtual function
				<I>onUpdateContextMenu</I></P>
			</TD>
			<TD WIDTH=63%>
				<P CLASS="western" STYLE="font-style: normal">Implement to allow
				views to customize the updating of their context menu.  Note that
				views only need to implement this function if the actual set of
				menu items can change at runtime (eg LiveViewBlock).  If only the
				attributes of menu items (checkstate, enabled etc) change, views
				should provide menu item updater functions in the data provider
				instead.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=37%>
				<P CLASS="western">virtual function <I>free</I> 
				</P>
			</TD>
			<TD WIDTH=63%>
				<P CLASS="western">Implement to allow views to drop reference to
				any circularly-referenced child objects, prior to the view being
				no longer used.  This is to ensure that actionscript's garbage
				collection is able to successfully delete the entire tree of
				unused objects<SPAN STYLE="font-style: normal">.</SPAN></P>
			</TD>
		</TR>
	</TABLE>
	<P CLASS="western"><SPAN STYLE="font-style: normal">Note that
	IntegraView itself does not contain resizing or expand/collapsing
	functionality; this functionality is provided by the class
	</SPAN><I>ViewHolder.  </I><SPAN STYLE="font-style: normal">Therefore
	these functions will only be executed from views which are
	instantiated within a </SPAN><I>ViewHolder.</I></P>
	<H4 CLASS="western"><I>3.3.2.Classes relating to presentation of
	views</I></H4>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Because
	there are many commonalities in the way views are presented within
	the top level application framework, there are some classes which
	act as containers for views, in order to reuse code wherever there
	are similarities and patterns.  Source files relating to these
	classes are located in the source tree under the directory
	src/components/views/viewContainers.</FONT></FONT></P>
	<H5 CLASS="western">3.3.2.1.ViewHolder</H5>
	<P CLASS="western"><I>ViewHolder</I> is a container for <I>IntegraView</I>.<SPAN STYLE="font-style: normal">
	 Since there are many similarities and many differences between the
	ways in which different views are presented, </SPAN><I>ViewHolder
	</I><SPAN STYLE="font-style: normal">has a broad range of optional
	functionality, so that views can mix &amp; match the subset of
	functionality they use.  </SPAN>
	</P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ViewHolder
	</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">provides
	the following functionality: </SPAN></FONT></FONT>
	</P>
	<UL>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Titlebar
		  (mandatory)</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Name
		(mandatory)</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Editable
		name (optional)</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Embedded
		view in titlebar; embedded view provided by contained view,
		different embedded views can be provided during ViewHolder's
		lifecycle (optional)</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Embedded
		aggregate vu meter in titlebar (optional)</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Collapse/Expand
		functionality (optional)</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Changing
		height from bottom (optional)</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Changing
		height from top (optional)</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Changing
		width from left (optional)</FONT></FONT></P>
		<LI><P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>embedded
		timeline view below titlebar (optional)</FONT></FONT></P>
	</UL>
	<P CLASS="western"><BR><BR>
	</P>
	<P CLASS="western"><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>ViewHolder
	</FONT></FONT></I><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">has
	no direct visibility of concrete view classes; it interacts with
	them via virtual functions defined in </SPAN></FONT></FONT><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>IntegraView
	</FONT></FONT></I><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">(described
	above), and receives notifications from them via IntegraViewEvents
	dispatched from </SPAN></FONT></FONT><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>IntegraView,
	</FONT></FONT></I><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">in
	a manner which is transparent to concrete view classes.</SPAN></FONT></FONT></P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">Not
	all views are managed by an </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ViewHolderl;
	</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">views
	which have their own title bar are, and views which do not have
	their own title bar are not.</SPAN></FONT></FONT></P>
	<P CLASS="western"><SPAN STYLE="font-style: normal">Views which </SPAN><SPAN STYLE="font-style: normal"><B>are</B></SPAN><SPAN STYLE="font-style: normal">
	contained by </SPAN><I>ViewHolder: ArrangeView, ArrrangeViewTrack,
	BlockLibrary, ArrangeViewProperties, ModuleGraph, ModuleLibrary,
	ModuleProperties, LiveView, KeybindingView, ArrrangeViewTrack,
	LiveViewTrack.</I></P>
	<P CLASS="western" STYLE="font-style: normal">Views which <B>are not</B>
	contained by <I>ViewHolder</I>: <I>RibbonBar, MainViewContainer,
	BlockPropertiesToolbar, ScenePropertiesToolbar, LiveViewBlock,
	BlockView, EnvelopeView, RoutingView, ScriptingView, RoutingItem,
	ScriptingItem, TrackColorPicker, TimeLine.</I></P>
	<H5 CLASS="western">3.3.2.2.ViewTree</H5>
	<P CLASS="western" STYLE="font-style: normal"><I>ViewTree </I>is a
	container for <I>ViewHolder</I>-contained views, which presents a
	scrollable, expand/collapsible list of views.  It is used to present
	collapsible tracks in the arrange view and live view.  <I>ViewTree
	</I>presents a public interface similar to that found in common list
	classes, with commands to insert, remove, retrieve items.  <I>ViewTree
	</I>implements optional tree reordering functionality (via drag &amp;
	drop of views' titlebars).</P>
	<H5 CLASS="western" STYLE="font-style: normal">3.3.2.3.IntegraViewEvent</H5>
	<P CLASS="western" STYLE="font-style: normal">IntegraViewEvent is a
	custom event class which manages communication from <I>IntegraView
	</I>to it's containing <I>ViewHolder.  </I>It can represent a
	variety of different event types.  Concrete view classes and their
	owners should not need to use this event class directly; it should
	be an internal implementation detail between <I>IntegraView </I>and
	<I>ViewHolder</I>.</P>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<H4 CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=4>3.3.3.GUI
	widget classes</FONT></FONT></H4>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Many
	views contain visual subcomponents which are too complex to use
	existing mxml controls, but do not contain enough functionality to
	be free-standing 'views' themselves.  These have been implemented as
	dumb leaf 'widgets' – they should not interact with the model or
	controller, instead they receive imput from their owner via settable
	properties, and communicate input back to their owner through flash
	events.  Typically these widgets perform specialised roles relating
	to only one view, so are not reused by other views.</FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	set of widget classes are:</FONT></FONT></P>
	<UL>
		<LI><P CLASS="western"><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>KeyIcon
		– </FONT></FONT></I><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">An
		individual 'key' visualisation used by </SPAN></FONT></FONT><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>KeybindingView.</FONT></FONT></I></P>
		<LI><P CLASS="western"><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>BackUpButton
		– </FONT></FONT></I><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">The
		large button in </SPAN></FONT></FONT><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>ModuleGraph,
		</FONT></FONT></I><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">used
		to return to </SPAN></FONT></FONT><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>ArrangeView.</FONT></FONT></I></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ConnectionPin
		– </I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">The
		input and output pin visualisations on modules, used by
		</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ModuleGraph.</I></FONT></FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ModuleGraphElement</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>–
		</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">The
		visualisation of individual modules used in </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ModuleGraph.</I></FONT></FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ModuleGraphLink</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>–
		</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">The
		visualisation of audio stream connections used in </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ModuleGraph.</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		</SPAN></FONT></FONT>
		</P>
		<LI><P CLASS="western"><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>RibbonButton
		– </FONT></FONT></I><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">The
		buttons used by </SPAN></FONT></FONT><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>RibbonBar</FONT></FONT></I><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		(for arrange view / live view and lighting toggle).</SPAN></FONT></FONT></P>
		<LI><P CLASS="western"><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>PlayPositionMarker</FONT></FONT></I><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">
		– The triangle and vertical line indicating play position, used
		by </SPAN></FONT></FONT><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>TimeLine
		</FONT></FONT></I><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">and
		</SPAN></FONT></FONT><I><FONT FACE="Arial, sans-serif"><FONT SIZE=2>ArrangeView.</FONT></FONT></I></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>SceneBar
		 – </I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">The
		visual representation of individual scenes used by </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>TimeLine.</I></FONT></FONT></P>
		<LI><P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>ScriptingViewTextArea</I></FONT></FONT>
		–<SPAN STYLE="font-style: normal"> A TextArea extension featuring
		code highlighting, taken from a code highlighting system written by
		Anirudh Sasikumar.</SPAN></P>
		<P CLASS="western" STYLE="font-style: normal"></P>
	</UL>
	<H4 CLASS="western"><I>3.3.4.Skin Classes</I></H4>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Many
	views and gui widgets use standard MXML controls, but customise
	their appearance using programmatic skins.  These skins are
	typically reused by multiple views and gui widgets, and their
	appearance can be styled as necessary.  The following table shows
	the set of skins, the controls they are used for, and the styles
	they respond to:</FONT></FONT></P>
	<TABLE WIDTH=100% BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0>
		<COL WIDTH=85*>
		<COL WIDTH=85*>
		<COL WIDTH=85*>
		<TR VALIGN=TOP>
			<TH WIDTH=33%>
				<P CLASS="western">Skin</P>
			</TH>
			<TH WIDTH=33%>
				<P CLASS="western">Control skin is used for</P>
			</TH>
			<TH WIDTH=33%>
				<P CLASS="western">Styles skin responds to</P>
			</TH>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>AddButtonSkin</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Button</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>color, fillColor, fillAlpha</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>CloseButtonSkin</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Button</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>color, fillColor, fillAlpha</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>CollapseButtonSkin</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Button</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>color</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>ComboBoxSkin</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>ComboBox</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>colorScheme</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>IntegraScrollThumbSkin</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Scrollbar Thumb 
				</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>colorScheme</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>IntegraScrollTrackSkin</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Scrollbar Track</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>colorScheme</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>TabButtonSkin</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Button</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>colorScheme</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>TickButtonSkin</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>Button</P>
			</TD>
			<TD WIDTH=33%>
				<P CLASS="western" ALIGN=CENTER>color</P>
			</TD>
		</TR>
	</TABLE>
	<P CLASS="western" STYLE="font-style: normal">  
	</P>
	<H4 CLASS="western"><I>3.3.5.Mouse Capture</I></H4>
	<P CLASS="western" STYLE="font-style: normal">In any application in
	which objects can be dragged by a pointing device, it is necessary
	to 'capture' mouse input during drag operations, so that mouse input
	messages are relayed to the part of the program responsible for
	handling the drag operation, regardless of the current position of
	the mouse, until the drag operation ends.  Even if the mouse leaves
	the application window altogether, and passes over another
	application, the dragged object should continue to receive mouse
	input.  
	</P>
	<P CLASS="western" STYLE="font-style: normal">Most development
	environments provide a simple mechanism to achieve this
	functionality, however in flash it is not simple; it requires a
	cumbersome process of multiple event listeners.</P>
	<P CLASS="western"><SPAN STYLE="font-style: normal">IntegraLive GUI
	encapsulates this complexity by providing a simple utility class
	</SPAN><I>MouseCapture, </I><SPAN STYLE="font-style: normal">which
	exposes simple static public functions for capturing and receiving
	mouse input.  </SPAN>
	</P>
	<P CLASS="western"><SPAN STYLE="font-style: normal">As an additional
	benefit, the </SPAN><I>MouseCapture </I><SPAN STYLE="font-style: normal">utility
	assigns a numeric ID to each mouse capture operation, so that each
	drag operation which is tracked by </SPAN><I>MouseCapture </I><SPAN STYLE="font-style: normal">can
	be uniquely identified by the function </SPAN><I>MouseCapture.getCaptureID().
	 </I><SPAN STYLE="font-style: normal">This mechanism is used by
	</SPAN><I>UndoManager </I><SPAN STYLE="font-style: normal">to
	determine whether commands should be within the same transaction as
	a previous command (see discussion of undo stack above).</SPAN></P>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<H3 CLASS="western" STYLE="font-style: normal">3.4.Top Level
	Application Framework</H3>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>The
	top level of the application is implemented in main.mxml. 
	Conceptually it is outside it MVC – it is responsible for
	instantiating the views, and also manages the main application
	window, application level menus etc.</FONT></FONT></P>
	<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Its
	main features are as follows:</FONT></FONT></P>
	<H4 CLASS="western">3.4.1.Instantiation of Views</H4>
	<P CLASS="western"><SPAN STYLE="font-style: normal">The application
	framework instantiates the views </SPAN><I>RibbonBar </I><SPAN STYLE="font-style: normal">and
	</SPAN><I>MainViewContainer, </I><SPAN STYLE="font-style: normal">thus
	initiating the cascading tree of view instantiation described above
	in “The Views” above.</SPAN></P>
	<H4 CLASS="western"><I>3.4.2.Menus</I></H4>
	<P CLASS="western" STYLE="font-style: normal">The application
	framework defines the main application menus, including 'handler'
	functions (executed when menu items are chosen, these implement the
	menu items' functionality) and 'updater' functions (executed when
	menus are displayed, these update each menu item's check state,
	enabled state etc).</P>
	<H4 CLASS="western">3.4.3.<I>Persistant</I><SPAN STYLE="font-style: normal">
	</SPAN><I>State</I></H4>
	<P CLASS="western"><SPAN STYLE="font-style: normal">The application
	framework contains the entrypoint for functionality to load and
	store persistent view layout state from an xml file called
	“IntegraLiveguiapplicationState.xml”, which is stored in the
	OS-specific application storage directory.  The functions
	</SPAN><I>loadPersistantState </I><SPAN STYLE="font-style: normal">and
	</SPAN><I>storePersistantState</I><SPAN STYLE="font-style: normal">
	handle the top level window position and show state (maximised vs
	normal) and the application-level font size.  They then delegate
	some more view-specific persistent state settings to the class
	</SPAN><I>MainViewContainer.</I></P>
	<H4 CLASS="western"><I>3.4.4.Save Changes Functionality </I>
	</H4>
	<P CLASS="western" STYLE="font-style: normal">Whenever the user
	navigates away from an open project (by starting a new project,
	opening a different project, or closing the application), the
	application framework checks whether the project state has changed
	since it was last saved.  If it has changed, it displays a message
	box asking whether the user would like to save their changes
	(yes|no|cancel).  If they opt to save their changes, it checks
	whether the project has already been saved, and automatically
	performs a 'save' or 'save as' operation as appropriate, before
	continuing with the operation they instigated before the “Save
	Modified” prompt was displayed.</P>
	<H4 CLASS="western"><I>3.4.5.Modal state</I></H4>
	<P CLASS="western"><SPAN STYLE="font-style: normal">When IntegraLive
	GUI loads data from the server, using the class </SPAN><I>ModelLoader
	</I><SPAN STYLE="font-style: normal">as described above, the
	application becomes temporarily locked.  This happens in the
	following circumstances:</SPAN></P>
	<OL>
		<LI><P CLASS="western" STYLE="font-style: normal">Loading the
		application</P>
		<LI><P CLASS="western" STYLE="font-style: normal">Creating a new
		project</P>
		<LI><P CLASS="western" STYLE="font-style: normal">Loading a project</P>
		<LI><P CLASS="western" STYLE="font-style: normal">Importing Tracks,
		Blocks, or Modules from disk</P>
	</OL>
	<P CLASS="western" STYLE="font-style: normal">The reason this is
	done is to prevent the user from carrying out any additional actions
	when the internal model could be in an interim state, rather than
	beingfully synchronised with libIntegra.</P>
	<P CLASS="western" STYLE="font-style: normal">The application
	framework is responsible for putting the application into this
	locked state, and unlocking it when the loading operation is
	complete.  It does this by displaying an invisible modal dialog
	(this greying out the rest of the application and throttling input
	messages), and disabling all menu commands except for 'exit'.</P>
	<P CLASS="western"><SPAN STYLE="font-style: normal">The functions
	responsible for handling 'modal state' are called </SPAN><I>enterModalState</I><SPAN STYLE="font-style: normal">
	and </SPAN><I>finishModalState</I><SPAN STYLE="font-style: normal">.</SPAN></P>
	<H4 CLASS="western"><I>3.4.6.Application-wide Styles</I></H4>
	<P CLASS="western" STYLE="font-style: normal">There are a few styles
	which are set at the application level.  Some of these are fixed for
	the lifecycle of the application, and some can change at runtime.</P>
	<H5 CLASS="western">3.4.6.1.Fixed styles</H5>
	<UL>
		<LI><P CLASS="western">The application-wide embedded font-face
		“standard_07_56_Regular.ttf” is applied as the font used
		throughout the application.</P>
		<LI><P CLASS="western">The custom-rendered skins
		<I>IntegraScrollTrackSkin </I><SPAN STYLE="font-style: normal">and
		</SPAN><I>IntegraScrollThumbSkin </I><SPAN STYLE="font-style: normal">are
		applied for all scrollbars throughout the application, and up and
		down arrows are removed for all scrollbars.</SPAN></P>
		<LI><P CLASS="western"><SPAN STYLE="font-style: normal">The
		custom-rendered skin </SPAN><I>ComboBoxSkin</I><SPAN STYLE="font-style: normal">
		is applied for all combo boxes throughout the application.</SPAN></P>
	</UL>
	<H5 CLASS="western" STYLE="font-style: normal">3.4.6.2.Styles which
	can change at runtime</H5>
	<UL>
		<LI><P CLASS="western"><SPAN STYLE="font-style: normal">The
		fontSize style is applied at the application level, and effects all
		text in the application except when explicitly overridden to
		achieve hardcoded font sizes in certain places.  Many gui
		components </SPAN><SPAN STYLE="font-style: normal">also resize
		themselves proportionately to the fontSize, in order to have enough
		room to display their text.</SPAN></P>
		<LI><P CLASS="western" STYLE="font-style: normal">The colorScheme
		style is applied at the application level.  This is a custom style
		– it has no inherent meaning in flash, but is interpreted by
		views, skins and gui widgets so that they can draw themselves in
		the two colour schemes 'light' and 'dark' available in IntegraLive
		GUI.</P>
	</UL>
	<H3 CLASS="western" STYLE="font-style: normal">3.5.Utility classes</H3>
	<P CLASS="western"><SPAN STYLE="font-style: normal">Within the
	directory </SPAN><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">src/components/util/
	are a set of reusable helper classes.  These are conceptually
	outside the MVC as they tend to be reused by multiple classes. 
	Their purposes are as follows:</SPAN></FONT></FONT></P>
	<H4 CLASS="western">3.5.1.ControlContainer	</H4>
	<P CLASS="western">The class <I>ControlContainer </I><SPAN STYLE="font-style: normal">is
	the main GUI application's bridge with the control plugins.  It
	loads and displays them, sets their values via flash local
	connections, listens to their responses, and fires Controller
	commands when module attribute value change as a result of control
	plugins.</SPAN></P>
	<P CLASS="western" STYLE="font-style: normal">It contains some
	marshalling code to convert between different attribute types and
	scales, and supports 'enumeration' type controls by handling the
	'allowed value' field of attribute definitions.</P>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">For
	more information about the control plugin architecture see the
	separate document called “</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal"><B>Integra
	Live GUI Control Plugin Architecture</B></SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">”.</SPAN></FONT></FONT></P>
	<H4 CLASS="western">3.5.2.AggregateVUContainer	</H4>
	<P CLASS="western" STYLE="font-style: normal">The class
	<I>AggregateVUContainer </I>is a specialised version of
	ControlContainer, used to embed vu meter controls into views'
	titlebars.  It is far simpler than ControlContainer, since it only
	has to connect with one type of control, and only needs to send
	information in one direction (vu meters are readonly controls).</P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="font-style: normal">Unlike
	<I>ControlContainer, AggregateVUContainer</I> does not directly
	display the value of module attributes.  Instead, it calculates the
	maximum value of all AudioOut and StereoAudioOut modules' <I>vu
	</I>attributes for a given container, and sends this maximum value
	to the vuMeter control.  Therefore, <I>AggregateVUContainer
	</I>instances display the 'aggregate' vu for a container, rather
	than individual vu attributes.</P>
	<H4 CLASS="western">3.5.3.ControlMeasurer	</H4>
	<P CLASS="western">Controls specify their own default, minimum and
	maximum dimensions, but the GUI needs to know this information when
	laying controls out in the module properties view and adding them to
	the live view.</P>
	<P CLASS="western" STYLE="font-style: normal">Since controls are
	delay-loaded, it's impossible to query them for their default,
	minimum and maximum sizes until one has been loaded.  And since
	they're plugins, the GUI could find itself loading controls which
	didn't even exist when the GUI was compiled.  So, on startup the GUI
	preloads one instance of each control, in order to query and store
	these dimensions, before unloading the control.  This is done in the
	singleton class <I>ControlMeasurer</I>, which then exposes query
	functions to obtain these control dimension data. 
	</P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<H4 CLASS="western">3.5.4.ControlPool	</H4>
	<P CLASS="western" STYLE="font-style: normal">Loading controls can
	be timeconsuming – it is a memory intensive procedure and in terms
	of user experience, actions which cause controls to load are the
	least 'responsive' in IntegraLive GUI.  To mitigate this problem,
	<I>ControlPool </I>maintains a collection of instances of all the
	controls which have been loaded previously, so that they can be
	reused instead of new ones being loaded.  
	</P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="font-style: normal">When a displayed
	control instance is no longer needed, instead of unloading the
	plugin .swf, and dropping all references to it so that the flash
	garbage collection can free it, it is merely removed from the
	display list, and a reference to it is passed to <I>ControlPool,
	</I>which can retrieve it when it is next needed.</P>
	<H4 CLASS="western">3.5.5.CursorSetter	</H4>
	<P CLASS="western" STYLE="font-style: normal">The class <I>CursorSetter
	</I>defines an enumeration with entries for each of IntegraLive
	GUI's custom mouse pointers.  It also embeds the graphic resources
	for each of these mouse pointers, and exposes static functions to
	set and remove custom mouse pointers.   These functions are used by
	all views and GUI widgets which use custom mouse pointers.  
	</P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="font-style: normal">Note that custom mouse
	pointers are referenced by ID.  The function <I>CursorSetter.setCursor</I>
	returns a mouse cursor ID; this ID must be tracked by the caller in
	order to be passed into <I>CursorSetter.removeCursor </I>when the
	custom cursor is removed.  This allows multiple custom-cursors to be
	'stacked up'.</P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="font-style: normal">Also note that the
	implementation of the function <I>CursorSetter.setCursor</I> defines
	the 'active point' offset for each custom cursor type.  If new
	custom cursors are added, or cursor graphics are changed, these
	active point coordinates must be updated to reflect the desired
	active point for each custom cursor.</P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<H4 CLASS="western"><I>3.5.6.FontSize	</I></H4>
	<P CLASS="western"><SPAN STYLE="font-style: normal">The class
	</SPAN><I>FontSize </I><SPAN STYLE="font-style: normal">defines an
	enumeration of font sizes, as well as static methods to iterate up
	and down through the set of font sizes, and methods to obtain 'row
	height' and 'button height' relative to fontSize.  These helpers are
	used to scale application components which need to resize when the
	application-level font size changes.</SPAN></P>
	<H4 CLASS="western">3.5.7.IntegraAlert	</H4>
	<P CLASS="western" STYLE="font-style: normal"><I>IntegraAlert </I>is
	a helper class to display the standard flash <I>Alert</I> with an
	appearance consistent with IntegraLive GUI's graphic designs.<I> 
	</I>This class should be used wherever alerts need to be displayed. 
	</P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<H4 CLASS="western">3.5.8.IntegraConnection	</H4>
	<P CLASS="western"><I>IntegraConnection </I><SPAN STYLE="font-style: normal">extends
	the </SPAN><I>ConnectionImpl </I><SPAN STYLE="font-style: normal">class
	in the XMLRPC library.  It adds to </SPAN><I>ConnectionImpl </I><SPAN STYLE="font-style: normal">the
	following functionality:</SPAN></P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<UL>
		<LI><P CLASS="western"><SPAN STYLE="font-style: normal">Call
		Queueing.  By using the method </SPAN><I>callQueued</I><SPAN STYLE="font-style: normal">
		instead of </SPAN><I>ConnectionImpl</I><SPAN STYLE="font-style: normal">.</SPAN><I>call,
		</I><I>users can add XMLRPC calls to a queue (maintained as static
		data within </I><I>IntegraConnection).</I><SPAN STYLE="font-style: normal">
		 Queued calls are not dispatched unless:</SPAN></P>
	</UL>
	<OL>
		<LI><P CLASS="western" STYLE="font-style: normal">The queue is
		already empty</P>
		<LI><P CLASS="western" STYLE="font-style: normal">The previous call
		completes</P>
		<P CLASS="western" STYLE="font-style: normal">Call queueing
		eliminates the possibility of XMLRPC calls being received by
		libIntegra in a different order to that in which they were sent.</P>
		<P CLASS="western" STYLE="font-style: normal"></P>
	</OL>
	<UL>
		<LI><P CLASS="western"><SPAN STYLE="font-style: normal">Instrumenting
		array parameters.  </SPAN><I>ConnectionImpl </I><SPAN STYLE="font-style: normal">expects
		array parameters to be provided in a cumbersome explicitly-typed
		format, where every element consists of an object containing a
		type/value pair.  The function </SPAN><I>IntegraConnection.buildArrayParam</I><SPAN STYLE="font-style: normal">
		allows native actionscript arrays to be passed in, and
		automatically constructs these type/value pairs.  This simplifies
		calling code by allowing it to use normal actionscript arrays.</SPAN></P>
		<P CLASS="western" STYLE="font-style: normal"></P>
		<LI><P CLASS="western"><SPAN STYLE="font-style: normal">Detecting
		server timeout.  If no response is received from an
		</SPAN><I>IntegraConnection </I><SPAN STYLE="font-style: normal">XMLRPC
		call to libIntegra after a hardcoded time interval (currently 60
		seconds), </SPAN><I>IntegraConnection </I><SPAN STYLE="font-style: normal">dispatches
		a </SPAN><I>ServerTimeOutEvent, </I><SPAN STYLE="font-style: normal">which
		is propogated via </SPAN><I>IntegraController </I><SPAN STYLE="font-style: normal">
		to the application framework, which alerts the user and closes the
		GUI. </SPAN>
		</P>
	</UL>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<H4 CLASS="western">3.5.9.IntegraSWFLoader	</H4>
	<P CLASS="western"><SPAN STYLE="font-style: normal">The class
	</SPAN><I>IntegraSWFLoader </I><SPAN STYLE="font-style: normal">extends
	the flash </SPAN><I>SWFLoader, </I><SPAN STYLE="font-style: normal">and
	is used to load control plugins.  </SPAN><I>IntegraSWFLoader </I><SPAN STYLE="font-style: normal">adds
	functionality to handle the flash two way LocalConnection
	communication between the main GUI application and control plugins. 
	</SPAN>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<H4 CLASS="western">3.5.10.LibraryRenderer	</H4>
	<P CLASS="western" STYLE="font-style: normal">The class
	<I>LibraryRenderer </I>is a custom item renderer used to create the
	appearance of items in <I>BlockLibrary </I>and <I>ModuleLibrary.  </I>It
	responds to the <I>colorScheme </I>style, and renders itself with a
	flash bevel filter, and a glow filter which lights up on mouse over.
	 
	</P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<P CLASS="western" STYLE="font-style: normal">It also tests for an
	“isUserItem” attribute on the data to be rendered, and uses a
	softer shade of background colour when this attribute exists and
	evaluates to &lt;true&gt;.  This allows <I>BlockLibrary </I>to
	achieve a distinction in appearance between user items and library
	items.</P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<H4 CLASS="western">3.5.11.MessagePopup	</H4>
	<P CLASS="western" STYLE="font-style: normal">The class <I>MessagePopup
	</I>displays a simple Alert-style popup message.  Unlike
	<I>IntegraAlert, MessagePopup </I>has no buttons.  It is displayed
	when the application enters a modal state, but has been hidden for
	cosmetic reasons.  Therefore, this class is largely redundant.</P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<H4 CLASS="western">3.5.12.RepositionType	</H4>
	<P CLASS="western"><I>RepositionType </I><SPAN STYLE="font-style: normal">is
	a simply enumeration, used by any part of the GUI in which different
	types of reposition operation need to be distinguished from each
	other.</SPAN></P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<H4 CLASS="western">3.5.13.StartControlRepositionEvent	</H4>
	<P CLASS="western" STYLE="font-style: normal">The class
	<I>StartControlRepositionEvent </I>is dispatched by <I>ControlContainer
	</I>when a control is repositioned.  Control reposition operations
	have to be initiated by the <I>ControlContainer, </I>because
	controls can be repositioned by clicking on any inactive area of the
	control plugin itself.   The event is received by any owner of
	<I>ControlContainer </I>in<I> </I>which controls can be repositioned
	(currently only <I>LiveViewBlock).</I></P>
	<P CLASS="western" STYLE="font-style: normal"><BR>
	</P>
	<H4 CLASS="western">3.5.14.Utilities	</H4>
	<P CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">The
	class </SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><I>Utilities
	</I></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">is
	a collection of reusable individual static helper functions.  </SPAN></FONT></FONT>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
	<P CLASS="western" STYLE="font-style: normal"><BR><BR>
	</P>
</DIV>
</BODY>
</HTML>